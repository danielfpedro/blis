$(function(){function a(n,t,o){var e=n.length,r=n.first(),i=r.data("base-url"),d=$("<img/>").attr("src",i+"img/main_post_placeholder.png");d.on("load",function(){var a=$(this),n=r.parent(".card-image-async-wrap");r.attr("src",a.attr("src")).css("height","auto"),n.css({height:r.height()+"px"})}),t<e-1?a(n,t+1,o):o.call()}function n(a){var t=$(".card-image-async:not(.img-loaded)").first();if(t.length<1)return void a.call();t.addClass("img-loaded");var o=$("<img/>").attr("src",t.data("original-src"));o.on("load",function(){var a=$(this),n=t.parent(".card-image-async-wrap");t.hide(),t.attr("src",a.attr("src")).fadeIn(500,function(){$(this).addClass("img-loaded"),n.css({height:"auto"})})}),window.setTimeout(function(){n(a)},0)}function t(a,n){var t=$(window).scrollTop(),o=a.offset().top,r=o-t,i=r-e;return i-n}function o(){window.setInterval(function(){if(!r&&!d&&t(i,700)<=0){console.log("Carregando mais."),r=!0;var a=parseInt(i.data("page")),o=i.data("not-in")?parseInt(i.data("not-in")):null,e=i.data("category");$.get(i.data("base-url"),{page:a,not_in:o,category:e},function(t){if(t.trim()){i.data("page",parseInt(a+1));var o=$(t);$(".grid").append(o).masonry("appended",o),$(".grid").masonry("layout"),n($(".card-image-async:not(.img-loaded)"),0,function(){console.log("Chamando load more")})}else d=!0;r=!1})}if(!r&&!c&&t(s,0)<=0){console.log("Carregando mais Small."),r=!0;var a=parseInt(s.data("page")),o=s.data("not-in")?parseInt(s.data("not-in")):null,e=i.data("category");$.get(s.data("base-url"),{page:a,not_in:o,category:e},function(t){t.trim()?(s.data("page",parseInt(a+1)),$("#load-more-small-container").append(t),n($(".card-image-async:not(.img-loaded)"),0,function(){})):(console.log("Carregou tudo."),c=!0),r=!1})}},1e3)}var e=$(window).height(),r=!1,i=$(".load-more"),d=!1,s=$(".load-more-small"),c=!1;$(".card-image-async").length;$(".grid").masonry({itemSelector:".grid-item",percentPosition:!0}),o(),a($(".card-image-async:not(.img-loaded)"),0,function(){$(".grid").masonry("layout"),n(function(){console.log("Chamando load more")})})});